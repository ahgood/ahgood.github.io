<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>白梁多情商课堂 - 情商小测试</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <!-- <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css"> -->

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">
  <link rel="stylesheet" href="css/swiper.min.css">

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="images/favicon.png">

</head>
<body>
  <div class="swiper-container" id="app">
    <div class="swiper-wrapper">
      <div class="swiper-slide" v-for="slideIndex in 40">
        <img :src="slideSrc(slideIndex)" alt="">
        <div class="select">
          <div @click.once="answer(slideIndex, answerIndex)" v-for="(chooice, answerIndex) in chooices">{{chooice}}</div>
        </div>
      </div>
      <div class="swiper-slide">
        <canvas id="canvas"></canvas>
      </div>
    </div>
  </div>

  <script src="js/vue.min.js"></script>
  <script src="js/swiper.min.js"></script>
  <script src="js/Chart.bundle.min.js"></script>
  <script>
  var swiper;
  var scores = [
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [1, 2, 3, 4, 5],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [1, 2, 3, 4, 5],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [1, 2, 3, 4, 5],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1],
      [5, 4, 3, 2, 1]
  ];

  var app = new Vue({
    el: '#app',
    data: {
      answers: [],
      chooices: ['非常符合', '基本符合', '一半符合', '有点不符合', '非常不符合']
    },
    methods: {
        answer(slideIndex, answerIndex){
          swiper.slideNext();
          this.answers.push([slideIndex - 1, answerIndex]);
          console.log(slideIndex - 1, answerIndex);
          if (slideIndex === 40) {
            // calculate score
            var score       = 0;
            var score_data  = [];
            for (i = 0; i < 8; i++) {
              score += scores[i][this.answers[i][1]];
            }
            score_data.push(score);

            score = 0;
            for (i = 8; i < 16; i++) {
              score += this.answers[i][1];
            }
            score_data.push(score);

            score = 0;
            for (i = 16; i < 24; i++) {
              score += this.answers[i][1];
            }
            score_data.push(score);

            score = 0;
            for (i = 24; i < 32; i++) {
              score += this.answers[i][1];
            }
            score_data.push(score);

            score = 0;
            for (i = 32; i < 40; i++) {
              score += this.answers[i][1];
            }
            score_data.push(score);

            score_data = score_data.map(function(item){
              return item * 2.5;
            });

            console.log(score_data);

            // init radar chart
            new Chart(
                document.getElementById("canvas"),
                {
                    "type":"radar",
                    "data":{
                        "labels":["自我意识","自我控制","自我激励","人际能力","社会影响"],
                        "datasets":[
                            {
                                "label": "情商小测试测评结果",
                                "data": score_data,
                                "fill": true,
                                "backgroundColor": "rgba(255, 99, 132, 0.2)",
                                "borderColor": "rgb(255, 99, 132)",
                                "pointBackgroundColor": "rgb(255, 99, 132)",
                                "pointBorderColor": "#fff",
                                "pointHoverBackgroundColor": "#fff",
                                "pointHoverBorderColor": "rgb(255, 99, 132)"
                            }
                        ]
                    },
                    "options":{
                        "elements": {
                            "line":{
                                "tension":0,
                                "borderWidth":3
                            }
                        }
                    }
                }
            );
          }
        },
        slideSrc(answerIndex) {
          return 'images/' + answerIndex + '.jpg';
        }
    },
    mounted() {
      swiper = new Swiper('.swiper-container', {
        allowTouchMove: false,
        onlyExternal: true,
      });
    }
  });
  </script>

  <style>
  html, body {
      position: relative;
      height: 100%;
  }
  body {
      background: #eee;
      font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
      font-size: 14px;
      color:#fff;
      margin: 0;
      padding: 0;
  }
  .swiper-container {
      width: 100%;
      height: 100%;
      margin-left: auto;
      margin-right: auto;
  }
  .swiper-slide {
      text-align: center;
      font-size: 18px;
      background: #fff;
      /* Center slide text vertically */
      display: -webkit-box;
      display: -ms-flexbox;
      display: -webkit-flex;
      display: flex;
      -webkit-box-pack: center;
      -ms-flex-pack: center;
      -webkit-justify-content: center;
      justify-content: center;
      -webkit-box-align: center;
      -ms-flex-align: center;
      -webkit-align-items: center;
      align-items: center;
  }
  .swiper-slide img {
    width: 100%;
  }
  .select {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 80px;
  }
  .select > div {
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.1rem;
  }
  .select > div:nth-child(1) {
    background-color: #000;
  }
  .select > div:nth-child(2) {
    background-color: #333;
  }
  .select > div:nth-child(3) {
    background-color: #666;
  }
  .select > div:nth-child(4) {
    background-color: #999;
  }
  .select > div:nth-child(5) {
    background-color: #ccc;
  }
  </style>

<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
</body>
</html>
